<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>添加联邦成员实例化信息</title>

    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <!-- required modeler styles -->
    <link rel="stylesheet" href="https://unpkg.com/bpmn-js@6.5.1/dist/assets/diagram-js.css">
    <link rel="stylesheet" href="https://unpkg.com/bpmn-js@6.5.1/dist/assets/bpmn-font/css/bpmn.css">
    <!-- modeler distro -->
    <script src="https://unpkg.com/bpmn-js@6.5.1/dist/bpmn-modeler.development.js"></script>
    <!-- needed for this example only -->
    <script src="https://unpkg.com/jquery@3.3.1/dist/jquery.js"></script>

    <link href="https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/4.4.1/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.js"></script>
    <script src="https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/4.4.1/js/bootstrap.min.js"></script>
    <!-- example styles -->
    <style>
        #canvas {
            padding: 0;
            width: 1200px;
            height: 400px;
            border:5px;
            border-style: dotted;
            border-color: red;
        }

        .diagram-note {
            background-color: rgba(66, 180, 21, 0.7);
            color: White;
            border-radius: 5px;
            font-family: Arial;
            font-size: 12px;

            padding: 5px;
            min-height: 16px;
            width: 50px;
            text-align: center;
        }

        .needs-discussion:not(.djs-connection) .djs-visual > :nth-child(1) {
            stroke: rgba(66, 180, 21, 0.7) !important; /* color elements as red */
        }

        #save-button {
            position: fixed;
            bottom: 20px;
            left: 20px;
        }
    </style>

    <style type="text/css">
        input{
            width: 200px;
        }
    </style>

</head>

<body>

    <div id="InitialInstanceDIV" >
    <div class="jumbotron">
        <h2>联邦成员实例初始化信息！</h2><br />
        <form id="InitialInstanceForm" action="/post/InitialInstance" method="post">
            <br>
            <div style="border: black;border-style: dotted;border-width: 2px;">
                <br />
                <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;实例来自的联邦成员名称:</span><input type="text" name="federate"><span>&nbsp;&nbsp;&nbsp;</span>
                <br /><br />
                <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;实例的数量:</span><input type="text" name="InstanceNumber"><span>&nbsp;&nbsp;&nbsp;</span><br/><br/>
                <!--                            <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;实例加入队列:</span><input type="text" name="listName"><span>&nbsp;&nbsp;&nbsp;</span>-->
                <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;实例加入队列:</span><select id="listSelect1" name="listName" ></select><br/><br/>
                <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;选择实例对象：</span>
                <select id="instanceSelect" name="instanceId" onchange="changeinstanceSelect()"></select>
                <br />
                <br />
                <div id="theInstanceAfter" >
                    <br />
                </div>
            </div>
            <button type="button" class="btn btn-info" style="margin-left: 280px" onclick="submitInitialInstance()">
                提交实例初始化信息
            </button>

        </form>
    </div>
</div>

<script>
    //主流程
    findCenterName();
    findCenterName2();

    function findCenterName(){
        //清空原有select内的数据
        $("#instanceSelect").empty();
        $.ajax({
            url: "/post/instanceSelect",
            type:"post",
            dataType:"json",
            success:function(data){
                if (data.stateCode == 200){
                    $("#instanceSelect").append("<option value='-1'>选择实例对象</option>");
                    //遍历 json为{id:"00",text:"aa".....},{id:"01",text:"bb".....}
                    for(let i=0; i<data.data.length; ++i){
                        var id = data.data[i].objectId;
                        var text = data.data[i].objectName;
                        $("#instanceSelect").append("<option value='"+id+"'>"+text+"</option>");
                    }
                }else {
                    alert(data.msg)
                }
            },
        });
    }

    function findCenterName2(){
        //清空原有select内的数据
        $("#listSelect1").empty();
        $.ajax({
            url: "/post/listSelect1",
            type:"post",
            dataType:"json",
            success:function(data){
                if (data.stateCode == 200){
                    $("#listSelect1").append("<option value='-1'>选择加入队列</option>");
                    //遍历 json为{id:"00",text:"aa".....},{id:"01",text:"bb".....}
                    for(let i=0; i<data.data.length; ++i){
                        let listName = data.data[i];
                        $("#listSelect1").append("<option value='"+listName+"'>"+listName+"</option>");
                    }
                }else {
                    alert(data.msg)
                }
            },
        });
    }

    function changeinstanceSelect(){
        let federateObjectId=$("#instanceSelect").val();
        let json = {
            "federateObjectId" : federateObjectId};
        $.ajax({
            url: "/post/showChoosenInstance",
            type:"post",
            data:JSON.stringify(json),
            contentType:'application/json;charset=utf-8',
            dataType:"json",
            success:function(data){
                if (data.stateCode == 200){
                    let html="";
                    let theInstanceAfter="";
                    for(let i=0; i<data.data.length; ++i){
                        html="<div >\n" +
                            "        <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;参数的名称:<span>"+data.data[i].instanceName+"</span><br/><br/>\n" +
                            "        <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;参数的类型:<span>"+data.data[i].instanceType+"</span><br/><br/>\n" +
                            "        <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;实例参数初值设置:</span>\n" +
                            "        <select name=\"isRandom\">\n" +
                            "           <option value=\"0\">随机整数</option>\n" +
                            "           <option value=\"1\">赋值</option>\n" +
                            "           <option value=\"3\">参数是一个对象</option>\n" +
                            "       </select><br/><br/>\n" +
                            "       <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;随机下限:</span><input type=\"text\" name=\"fromInt\" placeholder=\"-1\"><span>&nbsp;&nbsp;&nbsp;</span><br/>\n" +"<br>"+
                            "       <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;随机上限:</span><input type=\"text\" name=\"toInt\" placeholder=\"-1\"><span>&nbsp;&nbsp;&nbsp;</span><br/>\n" +"<br>"+
                            "       <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;初始赋值:</span><input type=\"text\" name=\"initialValue\" placeholder=\"-1\"><span>&nbsp;&nbsp;&nbsp;</span><br/>\n" +"<br>"+
                            "   </div>";
                        theInstanceAfter = document.getElementById("theInstanceAfter");
                        theInstanceAfter.insertAdjacentHTML("beforebegin",html);
                    }
                }else {
                    alert(data.msg)
                }
            },
        });
    }

    function submitInitialInstance() {
        var formId = "#InitialInstanceForm";
        var startInfoData = $(formId).serializeArray();
        $.ajax({
            url:"/post/initialInstance",
            type:"post",
            dataType:"text",
            data:startInfoData,
            success:function(result){
                alert(result);
            }
        });
    }
</script>

</body>